<!DOCTYPE html>
{% load static %}
<html lang="en" data-theme="razza">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{% if title %}{{ title }}{% else %}Razza Defense{% endif %}</title>

  <!-- Tailwind + DaisyUI -->
  <script src="https://cdn.tailwindcss.com"></script>
    <script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          roseSoft: "#FCE7F3",
          roseDeep: "#DB2777",
          lilacSoft: "#F3E8FF",
        }
      }
    },
    daisyui: {
      themes: [
        {
          razza: {
            "primary": "#9b57f3",
            "secondary": "#e94ea3",
            "accent": "#bb79f4",
            "neutral": "#1f1f27",
            "base-100": "#ffffff",
            "base-200": "#f6f1ff",
          }
        }
      ]
    }
  }
</script>


  <!-- DaisyUI (optional but useful) -->
  <script src="https://cdn.jsdelivr.net/npm/daisyui@2.51.5/dist/full.js"></script>

  <!-- Remix icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css" rel="stylesheet">

  <!-- Small custom styles to match screenshot -->
  <style>
    /* body gradient like sample */
    body { background: linear-gradient(180deg, #fff 0%, #fbf7ff 100%); }

    /* subtle card border / soft shadow */
    .card-soft { background: white; border: 1px solid rgba(15,11,24,0.03); box-shadow: 0 6px 20px rgba(99,64,255,0.06); border-radius: 12px; }

    /* sidebar hover with subtle pink */
    .side-link:hover { background: rgba(233,78,163,0.06); color: #9b57f3; }

    /* active sidebar highlight */
    .side-active { background: rgba(155,87,243,0.06); color: #9b57f3; box-shadow: inset 0 0 0 1px rgba(155,87,243,0.06); }

    /* small device hide/translate */
    #sidebar { transition: transform .28s ease; }
    #sidebar.-hidden { transform: translateX(-100%); }

    /* overlay shown when sidebar is open on mobile */
    #mobileOverlay { transition: opacity .2s ease; }
  </style>
</head>
<body class="min-h-screen antialiased text-neutral-800">

<!-- SIDEBAR -->
<aside id="sidebar" class="fixed left-0 top-0 bottom-0 w-72 bg-[#faf6ff] border-r border-[#f1e9ff] backdrop-blur-sm p-6 md:translate-x-0 -translate-x-full z-40">
  <div class="flex items-center justify-between mb-8">
    <div class="text-2xl font-extrabold text-[#9b57f3]">RUKKAYYA</div>
    <button class="md:hidden" onclick="toggleSidebar()">
      <i class="ri-close-line text-xl"></i>
    </button>
  </div>

  <nav class="space-y-1">
    <a href="{% url 'userdashboard' %}" class="flex items-center gap-3 p-3 rounded-lg side-link side-active">
      <i class="ri-home-3-line text-2xl" style="color:#9b57f3"></i>
      <span class="font-medium">Dashboard</span>
    </a>

    <a href="{% url 'scan_email' %}" class="flex items-center gap-3 p-3 rounded-lg side-link hover:shadow-sm">
      <i class="ri-mail-check-line text-2xl" style="color:#e94ea3"></i>
      <span class="font-medium">Scan Email</span>
    </a>

    <a href="{% url 'phishing_report' %}" class="flex items-center gap-3 p-3 rounded-lg side-link hover:shadow-sm">
      <i class="ri-bar-chart-fill text-2xl" style="color:#7c3aed"></i>
      <span class="font-medium">Reports</span>
    </a>

    <a href="{% url 'user_settings' %}" class="flex items-center gap-3 p-3 rounded-lg side-link hover:shadow-sm">
      <i class="ri-settings-3-line text-2xl" style="color:#06b6d4"></i>
      <span class="font-medium">Account Settings</span>
    </a>

    <a href="{% url 'account_logout' %}" class="flex items-center gap-3 p-3 rounded-lg mt-4 text-sm text-rose-600 hover:bg-rose-50">
      <i class="ri-logout-circle-r-line text-xl"></i>
      <span>Logout</span>
    </a>
  </nav>

  <div class="mt-10 text-xs text-slate-400">
    Rukky Anti-Phishing Tool<br/>Â© All Rights Reserved
  </div>
</aside>

<!-- Mobile overlay -->
<div id="mobileOverlay" class="fixed inset-0 bg-black/30 opacity-0 hidden z-30"></div>

<!-- MAIN CONTENT -->
<div class="min-h-screen md:ml-72 transition-all">


  <!-- Top bar -->
  <header class="flex items-center justify-between bg-white/60 backdrop-blur-sm border-b border-transparent px-6 py-4">
    <div class="flex items-center gap-4">
      <button id="hamburger" class="md:hidden p-2 rounded" onclick="toggleSidebar()">
        <i class="ri-menu-line text-2xl"></i>
      </button>
      <h2 class="text-xl font-bold">Dashboard Overview</h2>
    </div>

    <div class="flex items-center gap-3 text-sm">
      <span class="text-gray-500 hidden md:inline">Hello,</span>
      <div class="flex items-center gap-2 bg-white card-soft px-3 py-1 rounded-full">
        <span class="text-sm font-medium">{{ request.user.username }}</span>
        <i class="ri-user-3-line text-lg text-[#9b57f3]"></i>
      </div>
    </div>
  </header>

  <!-- content area -->
  <main class="p-6 space-y-6" style="background: linear-gradient(90deg, #FCE7F3 0%, #F3E8FF 100%);">

    {% block content %}
    {% endblock %}

  </main>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Sidebar behaviour -->
<script>
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('mobileOverlay');
  const hamburger = document.getElementById('hamburger');

  function openSidebar () {
    sidebar.classList.remove('-translate-x-full');
    overlay.classList.remove('hidden');
    overlay.classList.add('block');
    overlay.style.opacity = '1';
  }
  function closeSidebar () {
    if (!sidebar.classList.contains('-translate-x-full')) {
      sidebar.classList.add('-translate-x-full');
    }
    overlay.style.opacity = '0';
    setTimeout(()=> overlay.classList.add('hidden'), 220);
  }
  function toggleSidebar () {
    if (sidebar.classList.contains('-translate-x-full')) openSidebar(); else closeSidebar();
  }

  // overlay click closes
  overlay.addEventListener('click', closeSidebar);

  // click anywhere outside sidebar (for desktops too)
  document.addEventListener('click', function(e) {
    const target = e.target;
    if (window.innerWidth >= 768) return; // only mobile
    if (!sidebar.contains(target) && !hamburger.contains(target)) {
      closeSidebar();
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const ctx = document.getElementById('riskChart');

    {% if risk_data %}
    const riskData = {{ risk_data|safe }};
    {% else %}
    const riskData = { High: 0, Low: 0, Medium: 0 };
    {% endif %}

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.keys(riskData),
            datasets: [{
                label: "Threat Count",
                data: Object.values(riskData),
                backgroundColor: ['#ec4899', '#a855f7', '#d946ef'],
                borderRadius: 8,
            }]
        },
        options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
        }
    });
});
</script>


</body>
</html>
